{% extends "base.html" %}
{% block main %}
{% load static %}
{% if post.head_image %}
<div class="banner" style="background-image: url({{ post.head_image.url }})">
{% else %}
<div class="banner">
{% endif %}
    <div class="max-width">
        <div class="banner-contents">
            <p class="today">{{ post.created_at|date:'M' }} <em>{{ post.created_at|date:'d' }}</em> {{ post.created_at|date:'D' }}</p>
        </div>
    </div>
</div>
<div class="view">
    <div class="max-width">
        <section class="wrap-box">
            <div class="inner">
                <!-- author -->
                <dl class="author-wrap">
                    <dt class="a11y-hidden">작성자</dt>
                    <dd class="author"><img src="{% static './images/profile.jpg' %}" alt="">{{ post.author }}</dd>
                    <dt class="a11y-hidden">작성일자</dt>
                    <dd class="created">{{ post.created_at|date:'Y년 m월 d일 D' }}</dd>
                </dl>
                <!-- //author -->

                <!-- category -->
                <dl class="category">
                    <dt class="a11y-hidden">Category</dt>
                    {% for tag in post.tags.iterator %}
                    <dd>{{tag}}</dd>
                    {% endfor %}
                </dl>
                <!-- //category -->
                <div class="title-wrap">
                    <h2>{{ post.title }}</h2>
                    <button class="btn-like">Like</button>
                </div>
                <hr>
                <div class="view-contents">
                    <p>
                        {{ post.content }}
                    </p>
                </div>
                <div class="justify-content-center">
                    {% if previous_post %}
                    <a href="{% url 'post_detail' previous_post.id %}">이전글</a>
                    {% endif %}
                    {% if next_post %}
                    <a href="{% url 'post_detail' next_post.id %}">이후글</a>
                    {% endif %}
                </div>
                {% if request.user.is_staff or request.user == post.author %}
                <div class="btn-group">
                    <a href="{% url 'post_update' post.id %}" class="btn-modify">
                        <span class="a11y-hidden">modify</span>
                    </a>
                    <button id="delete_bt" type="button" class="btn-delete">
                        <span id="delete_sp" class="a11y-hidden">delete</span>
                    </button>
                </div>
                {% endif %}
                <a href="{% url 'post_list' %}" class="btn-back">
                    <span class="a11y-hidden">Back</span>
                </a>
            </div>
        </section>
    </div>
</div>

<script>
    const delete_bt = document.getElementById('delete_bt')

    delete_bt.addEventListener('click', ()=>{
        delete_confirm = confirm('정말로 삭제하시겠습니까?')
        if (delete_confirm) {
            window.location.href="{% url 'post_delete' post.id %}"
        }
    })
</script>
{% endblock main %}